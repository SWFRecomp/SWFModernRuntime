# SWFModernRuntime

This is still a stupid idea.

# And we're still doing it anyway.

SWFModernRuntime is even more of a rip-off than [SWFRecomp](https://github.com/SWFRecomp/SWFRecomp), adding no creativity to the process of writing functions that a recompilation will use.

This repo got its idea from Wiseguy's [N64ModernRuntime](https://github.com/N64Recomp/N64ModernRuntime), which is actually further composed of two libraries: ultramodern and librecomp.

Wiseguy originally made ultramodern for the purpose of helping lead team members of pmret create a native pc port of the first Paper Mario. It implements many core features of libultra, the original N64 library that developers of games like Super Mario 64, Ocarina of Time, etc. would link against. Implementation of these features is obviously crucial to a native pc port of any N64 game.

On the other hand, librecomp was designed specifically with recomps in mind, acting as a glue layer between the recompiled C code generated by N64Recomp, and the OS functions in ultramodern.

Fortunately, Adobe released most of their control over Flash as part of the [Open Screen Project](https://web.archive.org/web/20080506095459/http://www.adobe.com/aboutadobe/pressroom/pressreleases/200804/050108AdobeOSP.html), Adobe removed many restrictions from their SWF format, including restrictions on creating software that _plays and renders SWF files_.

They even went as far as to [donate the Flex 3 SDK to Apache](https://www.pcworld.com/article/478324/adobe_donates_flex_to_apache-2.html) back in 2011, in favor of the wild uprising of HTML5. Apache Flex is now licensed under the, well, Apache License (a permissive open-source license).

## So what can this do right now?

Currently the runtime handles basic SWF version 4 actions, and some primitive
tags, including much of the `DefineShape` tag functionality.

It handles rendering of solid fills through the GPU, with no CPU calculations
or manual framebuffer writes.

Once on initialization, the runtime uploads all vertex data outputted by the
recompiler to the vertex buffer and transform data outputted by the recompiler
to a read-only storage buffer to be accessed easily later. The renderer accepts
the current shapes on the screen as arguments from the runtime and passes them
to a very small and efficient vertex shader:

<img width="801" height="639" alt="testswf" src="https://github.com/user-attachments/assets/82f36718-c718-46b1-a563-dfb11853ab7e" />

This shader also handles the use of transforms through the single static
storage buffer, and a per-shape uniform with a `uint` to specify a transform
index:

<img width="801" height="639" alt="testswftransform" src="https://github.com/user-attachments/assets/c90e46b0-3319-4d64-8deb-eb52762a5e17" />

Handling all of the uploads once on initialization results in almost zero
per-frame overhead once the SWF is running.

# Special Thanks

All the people that wildly inspire me. ðŸ˜‹

My very dear friend BlazinWarior.

From N64Recomp:

- Wiseguy
- DarÃ­o
- dcvz
- Reonu
- thecozies
- danielryb
- kentonm

From Archipelago:

- TheRealPixelShake
- Muervo_
- seto10987
- Rogue
- ArsonAssassin
- CelestialKitsune
- Vincent'sSin
- LegendaryLinux
- zakwiz
- jjjj12212

From RotMG:

- HuskyJew
- Nequ
- snowden
- MoonMan
- Auru
